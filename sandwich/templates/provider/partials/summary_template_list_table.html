{% load sortable %}
{% load lucide %}

<div class="overflow-x-auto rounded-box border border-base-200 bg-base-100">
  <table class="table">
    <thead>
      <tr>
        <th>{% sortable_column "Name" "name" %}</th>
        <th>Description</th>
        <th>Form</th>
        <th>{% sortable_column "Created" "created_at" %}</th>
        <th>{% sortable_column "Updated" "updated_at" %}</th>
        <th></th>
      </tr>
    </thead>
    <tbody>
      {% for template in templates %}
        <tr>
          <td>
            <a class="link"
               href="{% url "providers:summary_template_edit" organization_id=organization.id template_id=template.id %}">{{ template.name }}</a>
          </td>
          <td>
            <div class="max-w-md truncate">{{ template.description|default:"â€”" }}</div>
          </td>
          <td>
            <a class="link"
               href="{% url "providers:form_template" organization_id=organization.id form_id=template.form.id %}">{{ template.form.name }}</a>
          </td>
          <td>{{ template.created_at|date:DJANGO_DATE_FORMAT }}</td>
          <td>{{ template.updated_at|date:DJANGO_DATE_FORMAT }}</td>
          <td class="text-right">
            <button class="btn btn-ghost btn-sm"
                    type="button"
                    hx-get="{% url 'providers:summary_template_delete' organization_id=organization.id template_id=template.id %}"
                    hx-target="body"
                    hx-swap="beforeend"
                    hx-push-url="true"
                    aria-label="Delete {{ template.name }}">
              {% lucide "trash-2" class="h-4 w-4 text-red-500" %}
            </button>
          </td>
        </tr>
      {% empty %}
        <tr>
          <td colspan="6" class="text-center">
            {% if search %}
              No templates found matching "{{ search }}".
            {% else %}
              No templates found. <a href="{% url "providers:summary_template_add" organization_id=organization.id %}"
    class="link">Create your first template</a>.
            {% endif %}
          </td>
        </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% if templates.paginator.num_pages > 1 %}
  <nav aria-label="Template pagination" class="join mt-2">
    {% if templates.has_previous %}
      <a class="join-item btn"
         href="{% querystring page=templates.previous_page_number %}"
         aria-label="Previous">
        <span aria-hidden="true">&laquo; Previous</span>
      </a>
    {% else %}
      <button class="join-item btn" disabled aria-label="Previous">
        <span aria-hidden="true">&laquo; Previous</span>
      </button>
    {% endif %}
    <span class="join-item btn">Page {{ templates.number }} of {{ templates.paginator.num_pages }}</span>
    {% if templates.has_next %}
      <a class="join-item btn"
         href="{% querystring page=templates.next_page_number %}"
         aria-label="Next">
        <span aria-hidden="true">Next &raquo;</span>
      </a>
    {% else %}
      <button class="join-item btn" disabled aria-label="Next">
        <span aria-hidden="true">Next &raquo;</span>
      </button>
    {% endif %}
  </nav>
{% endif %}
