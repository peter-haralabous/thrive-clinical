{% load lucide %}

{% if query %}
  {# Command palette context - use HTMX to load modal #}
  {% for patient in patients %}
    <li>
      <a href="#"
         hx-get="{% url 'providers:patient_add_encounter' organization_id=organization.id patient_id=patient.id %}"
         hx-target="#modal-container"
         hx-swap="innerHTML">
        <div>
          {% lucide "user" class="result-icon-left" %}
          <div class="result-content">
            <div class="result-title">{{ patient.last_name }}, {{ patient.first_name }}</div>
            <div class="result-subtitle">
              DOB: {{ patient.date_of_birth|date:DJANGO_DATE_FORMAT|default:EMPTY_VALUE_DISPLAY }} â€¢ PHN: {{ patient.phn|default:EMPTY_VALUE_DISPLAY }}
            </div>
          </div>
          {% lucide "chevron-right" class="result-icon" %}
        </div>
      </a>
    </li>
  {% endfor %}
  <li>
    <a href="#"
       hx-get="{% url 'providers:patient_add' organization_id=organization.id %}?maybe_name={{ query|urlencode }}"
       hx-target="#modal-container"
       hx-swap="innerHTML">
      <div>
        {% lucide "user-plus" class="result-icon-left" %}
        <div class="result-content">
          <div class="result-title">Create patient "{{ query }}"</div>
        </div>
        {% lucide "chevron-right" class="result-icon" %}
      </div>
    </a>
  </li>
{% endif %}
