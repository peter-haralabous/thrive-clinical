{% load i18n lucide %}

{# djlint:off #}
<style>
  {% for enum_value in form.enum_values %}
    .enum-checkbox-{{ enum_value.value }}:checked {
      background-color: #{{ enum_value.color_code }};
      border-color: #{{ enum_value.color_code }};
    }
    .enum-color-{{ enum_value.value }} {
      background-color: #{{ enum_value.color_code }};
    }
  {% endfor %}
</style>
{# djlint:on #}
<div class="bg-base-100 rounded-lg border border-base-300">
  <div class="flex items-center justify-between px-4 py-3 border-b border-base-300 bg-base-50">
    <span class="text-sm font-medium text-base-content/70">{% trans "Filter Options" %}</span>
    <div class="flex items-center gap-2">
      <button type="button"
              class="btn btn-xs btn-ghost gap-1 text-primary hover:bg-primary/10"
              id="select-all-enum">
        {% lucide "check" class="w-3.5 h-3.5" %}
        {% trans "Select All" %}
      </button>
      <div class="w-px h-4 bg-base-300"></div>
      <button type="button"
              class="btn btn-xs btn-ghost gap-1 text-base-content/60 hover:bg-base-200"
              id="clear-all-enum">
        {% lucide "x" class="w-3.5 h-3.5" %}
        {% trans "Clear All" %}
      </button>
    </div>
  </div>
  <div class="max-h-80 overflow-y-auto">
    <div class="p-2">
      {% if form.enum_values %}
        {% for enum_value in form.enum_values %}
          <label class="flex items-center gap-3 px-3 py-2.5 cursor-pointer hover:bg-base-200/60 rounded-lg transition-colors group">
            <input type="checkbox"
                   name="values"
                   value="{{ enum_value.value }}"
                   class="checkbox checkbox-md enum-checkbox-{{ enum_value.value }} shrink-0"
                   {% if enum_value.value in form.values.value %}checked{% endif %} />
            <span class="text-sm font-medium text-base-content group-hover:text-base-content/90">{{ enum_value.label }}</span>
          </label>
        {% endfor %}
      {% elif form.enum_choices %}
        {% for value, label in form.enum_choices %}
          <label class="flex items-center gap-3 px-3 py-2.5 cursor-pointer hover:bg-base-200/60 rounded-lg transition-colors group">
            <input type="checkbox"
                   name="values"
                   value="{{ value }}"
                   class="checkbox checkbox-md shrink-0"
                   {% if value in form.values.value %}checked{% endif %} />
            <span class="text-sm font-medium text-base-content group-hover:text-base-content/90">{{ label }}</span>
          </label>
        {% endfor %}
      {% endif %}
    </div>
  </div>
</div>
<script>
  document.getElementById("select-all-enum")?.addEventListener("click", function() {
    document.querySelectorAll("#filter-controls input[type=checkbox]").forEach(cb => cb.checked = true);
  });
  document.getElementById("clear-all-enum")?.addEventListener("click", function() {
    document.querySelectorAll("#filter-controls input[type=checkbox]").forEach(cb => cb.checked = false);
  });
</script>
