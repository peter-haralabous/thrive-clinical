{% load lucide %}

<div class="flex flex-col w-full space-y-4 card card-border bg-base-100 px-6 py-4"
     id="summaries-section">
  <div class="flex justify-between items-center">
    <h3 class="m-0">Summaries</h3>
  </div>
  <div>
    {% if summaries %}
      <div class="overflow-x-auto">
        <table class="table">
          <thead>
            <tr>
              <th>Template</th>
              <th>Status</th>
              <th>Generated Date</th>
              <th class="w-12"></th>
            </tr>
          </thead>
          <tbody>
            {% for summary in summaries %}
              <tr class="hover">
                <td>
                  <a href="{% url 'providers:summary_detail' organization_id=organization.id summary_id=summary.id %}{% if is_slideout %}?slideout=1{% endif %}"
                     {% if is_slideout %}hx-get="{% url 'providers:summary_detail' organization_id=organization.id summary_id=summary.id %}?slideout=1" hx-target="body" hx-swap="beforeend"{% endif %}
                     class="flex items-center gap-2">
                    {% lucide "file-text" class="size-4" %}
                    {{ summary.title }}
                  </a>
                </td>
                <td>{% include 'provider/partials/summary_status_badge.html' with summary=summary size='sm' %}</td>
                <td>{{ summary.created_at|date:DJANGO_DATE_TIME_FORMAT }}</td>
                <td class="text-right">
                  <a href="{% url 'providers:summary_detail' organization_id=organization.id summary_id=summary.id %}{% if is_slideout %}?slideout=1{% endif %}"
                     {% if is_slideout %}hx-get="{% url 'providers:summary_detail' organization_id=organization.id summary_id=summary.id %}?slideout=1" hx-target="body" hx-swap="beforeend"{% endif %}
                     class="flex items-center gap-2 btn btn-sm">Details</a>
                </td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
      {% if summaries.paginator.num_pages > 1 %}
        <nav aria-label="Summaries pagination" class="join mt-4">
          {% if summaries.has_previous %}
            <a class="join-item btn"
               hx-get="{% url 'providers:encounter' organization_id=organization.id encounter_id=encounter.id %}?section=summaries&summaries_page={{ summaries.previous_page_number }}{% if is_slideout %}&slideout=1{% endif %}"
               hx-target="#summaries-section"
               hx-swap="outerHTML"
               aria-label="Previous">
              <span aria-hidden="true">&laquo; Previous</span>
            </a>
          {% else %}
            <button class="join-item btn" disabled aria-label="Previous">
              <span aria-hidden="true">&laquo; Previous</span>
            </button>
          {% endif %}
          <span class="join-item btn">Page {{ summaries.number }} of {{ summaries.paginator.num_pages }}</span>
          {% if summaries.has_next %}
            <a class="join-item btn"
               hx-get="{% url 'providers:encounter' organization_id=organization.id encounter_id=encounter.id %}?section=summaries&summaries_page={{ summaries.next_page_number }}{% if is_slideout %}&slideout=1{% endif %}"
               hx-target="#summaries-section"
               hx-swap="outerHTML"
               aria-label="Next">
              <span aria-hidden="true">Next &raquo;</span>
            </a>
          {% else %}
            <button class="join-item btn" disabled aria-label="Next">
              <span aria-hidden="true">Next &raquo;</span>
            </button>
          {% endif %}
        </nav>
      {% endif %}
    {% else %}
      <div class="text-center py-8 text-base-content/60">
        {% if encounter %}
          No summaries for this encounter.
        {% else %}
          No summaries for this patient.
        {% endif %}
      </div>
    {% endif %}
  </div>
</div>
