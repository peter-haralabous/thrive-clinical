{% load crispy_forms_tags lucide %}

<div class="mb-4" data-enum-formset>
  <h5 class="text-lg font-semibold mb-3">Options</h5>
  {{ formset.management_form }}
  <div id="enum-forms" class="space-y-3">
    {% for form in formset %}
      <div class="enum-form-row card bg-base-100 shadow-sm border border-base-300 relative {% if form.cleaned_data.DELETE %}hidden{% endif %}">
        {{ form.id }}
        <button type="button"
                class="delete-option-btn btn btn-ghost btn-sm btn-circle absolute top-2 right-2 z-10"
                title="Delete option">{% lucide "x" class="size-5" %}</button>
        <div class="card-body pt-3 pr-10 pb-4">
          <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
            {% for field in form.visible_fields %}
              {% if field.name != 'DELETE' %}
                {% include 'tailwind/field.html' with field=field form_show_labels=True %}
              {% endif %}
            {% endfor %}
          </div>
          <div class="hidden">{{ form.DELETE }}</div>
        </div>
      </div>
    {% endfor %}
  </div>
  <button type="button" class="btn btn-outline mt-3" id="add-option-btn">
    {% lucide "plus" class="size-5 mr-1" %}
    Add Option
  </button>
</div>
<script nonce="{{ request.csp_nonce }}">
  htmx.trigger('[data-enum-formset]', 'data-enum-formset:init')
</script>
